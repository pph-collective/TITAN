
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the TITAN model">
      
      
      
      
        <link rel="canonical" href="http://pph-collective.github.io/TITAN/api/exposures/hiv/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>HIV - TITAN</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#titan.exposures.hiv.HIV.agents" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="TITAN" class="md-header__button md-logo" aria-label="TITAN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TITAN
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HIV
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Overview
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../getting_started/" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../agent/" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="TITAN" class="md-nav__button md-logo" aria-label="TITAN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    TITAN
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../run_local/" class="md-nav__link">
        Running locally
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../run_oscar/" class="md-nav__link">
        Running on Oscar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../agent/" class="md-nav__link">
        Agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../agent_set/" class="md-nav__link">
        AgentSet
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Agent Exposures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Agent Exposures" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Agent Exposures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          HIV
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        HIV
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.agents" class="md-nav__link">
    agents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.dx_counts" class="md-nav__link">
    dx_counts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.name" class="md-nav__link">
    name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.stats" class="md-nav__link">
    stats
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.add_agent" class="md-nav__link">
    add_agent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.convert" class="md-nav__link">
    convert()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.diagnose" class="md-nav__link">
    diagnose()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.expose" class="md-nav__link">
    expose()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.get_acute_status" class="md-nav__link">
    get_acute_status()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.get_transmission_probability" class="md-nav__link">
    get_transmission_probability()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.init_agent" class="md-nav__link">
    init_agent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.init_class" class="md-nav__link">
    init_class()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.progress_to_aids" class="md-nav__link">
    progress_to_aids()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.remove_agent" class="md-nav__link">
    remove_agent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.set_stats" class="md-nav__link">
    set_stats()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.update_agent" class="md-nav__link">
    update_agent()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../knowledge/" class="md-nav__link">
        Knowledge
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4">
          Agent Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Agent Features" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Agent Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/haart/" class="md-nav__link">
        HAART
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/high_risk/" class="md-nav__link">
        High Risk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/incar/" class="md-nav__link">
        Incarceration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/external_exposure/" class="md-nav__link">
        External Exposure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/partner_tracing/" class="md-nav__link">
        Partner Tracing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/prep/" class="md-nav__link">
        PrEP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/random_trial/" class="md-nav__link">
        Random Trial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/syringe_services/" class="md-nav__link">
        Syringe Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../features/vaccine/" class="md-nav__link">
        Vaccine
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" type="checkbox" id="__nav_3_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_5">
          Agent Interactions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Agent Interactions" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Agent Interactions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interactions/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interactions/injection/" class="md-nav__link">
        Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interactions/pca/" class="md-nav__link">
        Peer Change Agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interactions/sex/" class="md-nav__link">
        Sex
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../location/" class="md-nav__link">
        Location
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../model/" class="md-nav__link">
        Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../partnering/" class="md-nav__link">
        Partnering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../population/" class="md-nav__link">
        Population
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../relationship/" class="md-nav__link">
        Relationship
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reporting/" class="md-nav__link">
        Reporting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/" class="md-nav__link">
        Utility Functions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.agents" class="md-nav__link">
    agents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.dx_counts" class="md-nav__link">
    dx_counts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.name" class="md-nav__link">
    name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.stats" class="md-nav__link">
    stats
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.add_agent" class="md-nav__link">
    add_agent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.convert" class="md-nav__link">
    convert()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.diagnose" class="md-nav__link">
    diagnose()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.expose" class="md-nav__link">
    expose()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.get_acute_status" class="md-nav__link">
    get_acute_status()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.get_transmission_probability" class="md-nav__link">
    get_transmission_probability()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.init_agent" class="md-nav__link">
    init_agent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.init_class" class="md-nav__link">
    init_class()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.progress_to_aids" class="md-nav__link">
    progress_to_aids()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.remove_agent" class="md-nav__link">
    remove_agent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.set_stats" class="md-nav__link">
    set_stats()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#titan.exposures.hiv.HIV.update_agent" class="md-nav__link">
    update_agent()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>HIV</h1>
                
                <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">





  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.agents">
<code class="codehilite language-python"><span class="n">agents</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">titan</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">Agent</span><span class="p">]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Agents with active hiv</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.dx_counts">
<code class="codehilite language-python"><span class="n">dx_counts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Counts of diagnosed agents by race and sex_type</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.name">
<code class="codehilite language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Name of exposure in the params file.  Also used to name the attribute in Agent</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.stats">
<code class="codehilite language-python"><span class="n">stats</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>HIV collects the following stats:</p>
<ul>
<li>hiv - number of agents with active hiv</li>
<li>hiv_dx - number of agents with diagnosed hiv</li>
<li>hiv_aids - number of agents with aids</li>
<li>hiv_new - number of agents converted to hiv this timestep</li>
<li>hiv_dx_new - number of agents with diagnosed with hiv this timestep</li>
</ul>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.add_agent">
<code class="codehilite language-python"><span class="n">add_agent</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Add an agent to the class (not instance).  This can be useful if tracking population level statistics or groups, such as counts or newly active agents.</p>
<p>Add the agent to the <code>agents</code> set and if the agent is diagnosed, updated the <code>dx_counts</code></p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>agent</code></td>
        <td><code>agent.Agent</code></td>
        <td><p>the agent to add to the class attributes</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_agent</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="s2">&quot;agent.Agent&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add an agent to the class (not instance).  This can be useful if tracking population level statistics or groups, such as counts or newly active agents.</span>

<span class="sd">    Add the agent to the `agents` set and if the agent is diagnosed, updated the `dx_counts`</span>

<span class="sd">    args:</span>
<span class="sd">        agent: the agent to add to the class attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">agent</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">dx</span><span class="p">:</span>  <span class="c1"># type: ignore[attr-defined]</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">dx_counts</span><span class="p">[</span><span class="n">agent</span><span class="o">.</span><span class="n">race</span><span class="p">][</span><span class="n">agent</span><span class="o">.</span><span class="n">sex_type</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.convert">
<code class="codehilite language-python"><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Agent becomes HIV agent. Update all appropriate attributes, sets and dictionaries.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td><code>model.TITAN</code></td>
        <td><p>The model being run</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.TITAN&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Agent becomes HIV agent. Update all appropriate attributes, sets and dictionaries.</span>

<span class="sd">    args:</span>
<span class="sd">        model: The model being run</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">vaccine</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># type: ignore[attr-defined]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_agent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">prep</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>  <span class="c1"># type: ignore[attr-defined]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">prep</span><span class="o">.</span><span class="n">progress</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.diagnose">
<code class="codehilite language-python"><span class="n">diagnose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Mark the agent as diagnosed.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td><code>model.TITAN</code></td>
        <td><p>the running model</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">diagnose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.TITAN&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mark the agent as diagnosed.</span>

<span class="sd">    args:</span>
<span class="sd">         model: the running model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dx_time</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_agent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.expose">
<code class="codehilite language-python"><span class="n">expose</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">interaction</span><span class="p">,</span> <span class="n">rel</span><span class="p">,</span> <span class="n">num_acts</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Expose a relationship to the exposure for a number of acts of a specific interaction type.  Typically, this is determining if the exposure can cause conversion/change in one of the agents, then if so determining the probability of that and then converting the succeptible agent.</p>
<p>For hiv, one agent must be active and the other not for an exposure to cause conversion.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td><code>model.TITAN</code></td>
        <td><p>The running model</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>interaction</code></td>
        <td><code>str</code></td>
        <td><p>The type of interaction (e.g. sex, injection)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>rel</code></td>
        <td><code>agent.Relationship</code></td>
        <td><p>The relationship where the interaction is occuring</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_acts</code></td>
        <td><code>int</code></td>
        <td><p>The number of acts of that interaction</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">expose</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.TITAN&quot;</span><span class="p">,</span>
    <span class="n">interaction</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">rel</span><span class="p">:</span> <span class="s2">&quot;agent.Relationship&quot;</span><span class="p">,</span>
    <span class="n">num_acts</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expose a relationship to the exposure for a number of acts of a specific interaction type.  Typically, this is determining if the exposure can cause conversion/change in one of the agents, then if so determining the probability of that and then converting the succeptible agent.</span>

<span class="sd">    For hiv, one agent must be active and the other not for an exposure to cause conversion.</span>

<span class="sd">    args:</span>
<span class="sd">        model: The running model</span>
<span class="sd">        interaction: The type of interaction (e.g. sex, injection)</span>
<span class="sd">        rel: The relationship where the interaction is occuring</span>
<span class="sd">        num_acts: The number of acts of that interaction</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Agent 1 is HIV+, Agent 2 is not, Agent 2 is succept</span>
    <span class="k">if</span> <span class="n">rel</span><span class="o">.</span><span class="n">agent1</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">active</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">rel</span><span class="o">.</span><span class="n">agent2</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>  <span class="c1"># type: ignore[attr-defined]</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">rel</span><span class="o">.</span><span class="n">agent1</span>
        <span class="n">partner</span> <span class="o">=</span> <span class="n">rel</span><span class="o">.</span><span class="n">agent2</span>
    <span class="c1"># If Agent 2 is HIV and Agent 1 is not, Agent 1 is succept</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">rel</span><span class="o">.</span><span class="n">agent1</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">active</span> <span class="ow">and</span> <span class="n">rel</span><span class="o">.</span><span class="n">agent2</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>  <span class="c1"># type: ignore[attr-defined]</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">rel</span><span class="o">.</span><span class="n">agent2</span>
        <span class="n">partner</span> <span class="o">=</span> <span class="n">rel</span><span class="o">.</span><span class="n">agent1</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># neither agent is HIV or both are</span>
        <span class="k">return</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">get_transmission_probability</span><span class="p">(</span>  <span class="c1"># type: ignore[attr-defined]</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">interaction</span><span class="p">,</span> <span class="n">partner</span><span class="p">,</span> <span class="n">num_acts</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">run_random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">:</span>
        <span class="c1"># if agent HIV+ partner becomes HIV+</span>
        <span class="n">partner</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.get_acute_status">
<code class="codehilite language-python"><span class="n">get_acute_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Get acute status of agent at time</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>time</code></td>
        <td><code>int</code></td>
        <td><p>The current time step</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>whether an agent is acute</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_acute_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get acute status of agent at time</span>

<span class="sd">    args:</span>
<span class="sd">        time: The current time step</span>

<span class="sd">    returns:</span>
<span class="sd">        whether an agent is acute</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hiv_duration</span> <span class="o">=</span> <span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">acute</span><span class="o">.</span><span class="n">duration</span> <span class="o">&gt;=</span> <span class="n">hiv_duration</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.get_transmission_probability">
<code class="codehilite language-python"><span class="n">get_transmission_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">interaction</span><span class="p">,</span> <span class="n">partner</span><span class="p">,</span> <span class="n">num_acts</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Determines the probability of an hiv transmission event from agent to partner based on
    interaction type and numer of acts. For sex acts, transmission probability is a
    function of the acquisition probability of the HIV- agent's sex role
    and the HIV+ agent's haart adherence, acute status, and dx risk reduction</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td><code>model.TITAN</code></td>
        <td><p>The running model</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>interaction</code></td>
        <td><code>str</code></td>
        <td><p>"injection" or "sex"</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>partner</code></td>
        <td><code>agent.Agent</code></td>
        <td><p>HIV- Agent</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_acts</code></td>
        <td><code>int</code></td>
        <td><p>The number of exposure interactions the agents had this time step</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>probability of transmission from agent to partner</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_transmission_probability</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.TITAN&quot;</span><span class="p">,</span>
    <span class="n">interaction</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">partner</span><span class="p">:</span> <span class="s2">&quot;agent.Agent&quot;</span><span class="p">,</span>
    <span class="n">num_acts</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines the probability of an hiv transmission event from agent to partner based on</span>
<span class="sd">        interaction type and numer of acts. For sex acts, transmission probability is a</span>
<span class="sd">        function of the acquisition probability of the HIV- agent&#39;s sex role</span>
<span class="sd">        and the HIV+ agent&#39;s haart adherence, acute status, and dx risk reduction</span>

<span class="sd">    args:</span>
<span class="sd">        model: The running model</span>
<span class="sd">        interaction : &quot;injection&quot; or &quot;sex&quot;</span>
<span class="sd">        partner: HIV- Agent</span>
<span class="sd">        num_acts: The number of exposure interactions the agents had this time step</span>

<span class="sd">    returns:</span>
<span class="sd">        probability of transmission from agent to partner</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if this isn&#39;t an interaction where hiv can transmit, return 0% prob</span>
    <span class="k">if</span> <span class="n">interaction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;injection&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="c1"># Logic for if needle or sex type interaction</span>
    <span class="n">p</span><span class="p">:</span> <span class="nb">float</span>

    <span class="c1"># get baseline probabilities</span>
    <span class="k">if</span> <span class="n">interaction</span> <span class="o">==</span> <span class="s2">&quot;injection&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">partnership</span><span class="o">.</span><span class="n">injection</span><span class="o">.</span><span class="n">transmission</span><span class="o">.</span><span class="n">base</span>
    <span class="k">elif</span> <span class="n">interaction</span> <span class="o">==</span> <span class="s2">&quot;sex&quot;</span><span class="p">:</span>
        <span class="n">agent_sex_role</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">sex_role</span>
        <span class="n">partner_sex_role</span> <span class="o">=</span> <span class="n">partner</span><span class="o">.</span><span class="n">sex_role</span>

        <span class="c1"># get partner&#39;s sex role during acts</span>
        <span class="k">if</span> <span class="n">partner_sex_role</span> <span class="o">==</span> <span class="s2">&quot;versatile&quot;</span><span class="p">:</span>  <span class="c1"># versatile partner takes</span>
            <span class="c1"># &quot;opposite&quot; position of agent</span>
            <span class="k">if</span> <span class="n">agent_sex_role</span> <span class="o">==</span> <span class="s2">&quot;insertive&quot;</span><span class="p">:</span>
                <span class="n">partner_sex_role</span> <span class="o">=</span> <span class="s2">&quot;receptive&quot;</span>
            <span class="k">elif</span> <span class="n">agent_sex_role</span> <span class="o">==</span> <span class="s2">&quot;receptive&quot;</span><span class="p">:</span>
                <span class="n">partner_sex_role</span> <span class="o">=</span> <span class="s2">&quot;insertive&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">partner_sex_role</span> <span class="o">=</span> <span class="s2">&quot;versatile&quot;</span>  <span class="c1"># if both versatile, can switch</span>
                <span class="c1"># between receptive and insertive by act</span>

        <span class="c1"># get probability of sex acquisition given HIV- partner&#39;s position</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">partner</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">partnership</span><span class="o">.</span><span class="n">sex</span><span class="o">.</span><span class="n">acquisition</span><span class="p">[</span><span class="n">partner</span><span class="o">.</span><span class="n">sex_type</span><span class="p">][</span>
            <span class="n">partner_sex_role</span>
        <span class="p">]</span>

    <span class="c1"># feature specific risk adjustment</span>
    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
        <span class="n">agent_feature</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span> <span class="n">feature</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">*=</span> <span class="n">agent_feature</span><span class="o">.</span><span class="n">get_transmission_risk_multiplier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">interaction</span><span class="p">)</span>

        <span class="n">partner_feature</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">partner</span><span class="p">,</span> <span class="n">feature</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">*=</span> <span class="n">partner_feature</span><span class="o">.</span><span class="n">get_acquisition_risk_multiplier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">interaction</span><span class="p">)</span>

    <span class="c1"># Scaling parameter for acute HIV infections</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acute_status</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">time</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">acute</span><span class="o">.</span><span class="n">infectivity</span>

    <span class="c1"># Scaling parameter for positively identified HIV agents</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">dx</span><span class="o">.</span><span class="n">risk_reduction</span><span class="p">[</span><span class="n">interaction</span><span class="p">]</span>

    <span class="c1"># Racial calibration parameter to attain proper race incidence disparity</span>
    <span class="n">p</span> <span class="o">*=</span> <span class="n">partner</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">demographics</span><span class="p">[</span><span class="n">partner</span><span class="o">.</span><span class="n">race</span><span class="p">]</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">transmission</span>

    <span class="c1"># Scaling parameter for per act transmission.</span>
    <span class="n">p</span> <span class="o">*=</span> <span class="n">model</span><span class="o">.</span><span class="n">calibration</span><span class="o">.</span><span class="n">acquisition</span>

    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">total_probability</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_acts</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.init_agent">
<code class="codehilite language-python"><span class="n">init_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Initialize the agent for this exposure during population initialization (<code>Population.create_agent</code>).  Called on only exposures that are enabled per the params.</p>
<p>Based on demographic params for the agent, stochastically determine if hiv is active, and if active, at what past time point was the agent converted, if the agent is diagnosed, and if the agent has aids.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>pop</code></td>
        <td><code>population.Population</code></td>
        <td><p>the population this agent is a part of</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>time</code></td>
        <td><code>int</code></td>
        <td><p>the current time step</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">init_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">:</span> <span class="s2">&quot;population.Population&quot;</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the agent for this exposure during population initialization (`Population.create_agent`).  Called on only exposures that are enabled per the params.</span>

<span class="sd">    Based on demographic params for the agent, stochastically determine if hiv is active, and if active, at what past time point was the agent converted, if the agent is diagnosed, and if the agent has aids.</span>

<span class="sd">    args:</span>
<span class="sd">        pop: the population this agent is a part of</span>
<span class="sd">        time: the current time step</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">agent_params</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">demographics</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">race</span><span class="p">]</span>
        <span class="o">.</span><span class="n">sex_type</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">sex_type</span><span class="p">]</span>
        <span class="o">.</span><span class="n">drug_type</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">drug_type</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># HIV</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">pop</span><span class="o">.</span><span class="n">pop_random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">agent_params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">init</span>
        <span class="ow">and</span> <span class="n">time</span> <span class="o">&gt;=</span> <span class="n">pop</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">start_time</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># if HIV, when did the agent convert? Random sample</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">safe_random_int</span><span class="p">(</span>
            <span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">max_init_time</span><span class="p">,</span>
            <span class="n">time</span><span class="p">,</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">pop_random</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">pop</span><span class="o">.</span><span class="n">pop_random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">agent_params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">aids</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aids</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">pop</span><span class="o">.</span><span class="n">pop_random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">agent_params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">dx</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># agent was diagnosed at a random time between conversion and now</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dx_time</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">safe_random_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">pop</span><span class="o">.</span><span class="n">pop_random</span><span class="p">)</span>

        <span class="c1"># add agent to class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_agent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.init_class">
<code class="codehilite language-python"><span class="n">init_class</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize any diagnosis counts and the agents set.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>params</code></td>
        <td><code></code></td>
        <td><p>parameters for this population</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">init_class</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize any diagnosis counts and the agents set.</span>

<span class="sd">    args:</span>
<span class="sd">        params: parameters for this population</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">dx_counts</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">race</span><span class="p">:</span> <span class="p">{</span><span class="n">so</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">so</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">sex_types</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">race</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">races</span>
    <span class="p">}</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">agents</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.progress_to_aids">
<code class="codehilite language-python"><span class="n">progress_to_aids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Model the progression of HIV agents to AIDS agents</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td><code>model.TITAN</code></td>
        <td><p>the running model</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">progress_to_aids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.TITAN&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model the progression of HIV agents to AIDS agents</span>

<span class="sd">    args:</span>
<span class="sd">         model: the running model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aids_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">aids</span><span class="o">.</span><span class="n">prob</span>
    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">haart</span><span class="o">.</span><span class="n">aids_scale</span><span class="p">()</span>  <span class="c1"># type: ignore[attr-defined]</span>

    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">run_random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">p</span> <span class="o">*</span> <span class="n">aids_prob</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aids</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.remove_agent">
<code class="codehilite language-python"><span class="n">remove_agent</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Remove an agent from the class (not instance).  This can be useful if tracking population level statistics or groups, such as counts.</p>
<p>Remove the agent from the <code>agents</code> set and decrement the <code>dx_counts</code> if the agent was diagnosed.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>agent</code></td>
        <td><code>agent.Agent</code></td>
        <td><p>the agent to remove from the class attributes</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">remove_agent</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="s2">&quot;agent.Agent&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove an agent from the class (not instance).  This can be useful if tracking population level statistics or groups, such as counts.</span>

<span class="sd">    Remove the agent from the `agents` set and decrement the `dx_counts` if the agent was diagnosed.</span>

<span class="sd">    args:</span>
<span class="sd">        agent: the agent to remove from the class attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">agent</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">dx</span><span class="p">:</span>  <span class="c1"># type: ignore[attr-defined]</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">dx_counts</span><span class="p">[</span><span class="n">agent</span><span class="o">.</span><span class="n">race</span><span class="p">][</span><span class="n">agent</span><span class="o">.</span><span class="n">sex_type</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.set_stats">
<code class="codehilite language-python"><span class="n">set_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Update the <code>stats</code> dictionary passed for this agent.  Called from <code>output.get_stats</code> for each enabled exposure in the model.</p>
<p>The stats to be updated must be declared in the class attribute <code>stats</code> to make sure the dictionary has the expected keys/counter value initialized.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>stats</code></td>
        <td><code>Dict[str, int]</code></td>
        <td><p>the dictionary to update with this agent's feature statistics</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>time</code></td>
        <td><code>int</code></td>
        <td><p>the time step of the model when the stats are set</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stats</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">time</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
        <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;hiv&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">==</span> <span class="n">time</span><span class="p">:</span>
            <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;hiv_new&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aids</span><span class="p">:</span>
            <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;hiv_aids&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">:</span>
            <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;hiv_dx&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx_time</span> <span class="o">==</span> <span class="n">time</span><span class="p">:</span>
                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;hiv_dx_new&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="titan.exposures.hiv.HIV.update_agent">
<code class="codehilite language-python"><span class="n">update_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Update the agent for this exposure for a time step.  Called once per time step in <code>TITAN.update_all_agents</code>. Agent level updates are done after population level updates.   Called on only exposures that are enabled per the params.</p>
<p>If the agent is hiv+ and the model time is past the hiv start_time, determine if the agent becomes diagnosed if not yet diagnosed, and if the agent has progressed to aids.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model</code></td>
        <td><code>model.TITAN</code></td>
        <td><p>the instance of TITAN currently being run</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>titan/exposures/hiv.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.TITAN&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the agent for this exposure for a time step.  Called once per time step in `TITAN.update_all_agents`. Agent level updates are done after population level updates.   Called on only exposures that are enabled per the params.</span>

<span class="sd">    If the agent is hiv+ and the model time is past the hiv start_time, determine if the agent becomes diagnosed if not yet diagnosed, and if the agent has progressed to aids.</span>

<span class="sd">    args:</span>
<span class="sd">        model: the instance of TITAN currently being run</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">start_time</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">:</span>
            <span class="n">test_prob</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">demographics</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">race</span><span class="p">]</span>
                <span class="o">.</span><span class="n">sex_type</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">sex_type</span><span class="p">]</span>
                <span class="o">.</span><span class="n">drug_type</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">drug_type</span><span class="p">]</span>
                <span class="o">.</span><span class="n">hiv</span><span class="o">.</span><span class="n">dx</span><span class="o">.</span><span class="n">prob</span>
            <span class="p">)</span>

            <span class="c1"># Rescale based on calibration param</span>
            <span class="n">test_prob</span> <span class="o">*=</span> <span class="n">model</span><span class="o">.</span><span class="n">calibration</span><span class="o">.</span><span class="n">test_frequency</span>

            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">run_random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">test_prob</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">diagnose</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progress_to_aids</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Overview
            </div>
          </div>
        </a>
      
      
        
        <a href="../knowledge/" class="md-footer__link md-footer__link--next" aria-label="Next: Knowledge" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Knowledge
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>